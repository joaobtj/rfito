[{"path":"index.html","id":"análises-estatísticas-com-o-r-experimentos-aplicados-à-fitopatologia","chapter":"Capítulo 1 Análises estatísticas com o R: Experimentos aplicados à Fitopatologia","heading":"Capítulo 1 Análises estatísticas com o R: Experimentos aplicados à Fitopatologia","text":"Este curso é voltado para análises estatísticas de experimentos na área de Fitopatologia.Serão descrita algumas das análises mais comuns dos experimentos executados Laboratório de Fitopatologia Campus de Curitibanos da Universidade Federal de Santa Catarina.","code":""},{"path":"index.html","id":"equipe","chapter":"Capítulo 1 Análises estatísticas com o R: Experimentos aplicados à Fitopatologia","heading":"1.1 Equipe","text":"Profa. Dra. Adriana Terumi ItakoProf. Dr. João Batista Tolentino Júnior","code":""},{"path":"aaccm.html","id":"aaccm","chapter":"Capítulo 2 Área Abaixo da Curva de Crescimento Micelial - AACCM","heading":"Capítulo 2 Área Abaixo da Curva de Crescimento Micelial - AACCM","text":"É um conceito da epidemiologia que analisa o crescimento da doença em função tempo.É feita pela quantificação da área uma gráfico que expressa evolução da quantidade de doença (eixo x) em função tempo (eixo y).caso crescimento micelial, observado em placas de Petri, quantidade de doença é medida pelo diâmetro ou raio da colônia.Na figura abaixo é mostrado um exemplo de uma curva de progresso da doença.\nFigura 2.1: Exemplo de uma curva de progresso da doença.\nárea abaixo da curva pode ser calculada pelo método dos trapézios, cuja fórmula é seguinte:\\[\nAAC = \\frac{1}{2} \\sum ((X_{+1}+X_i) \\cdot (T_{+1}-T_i))\n\\]software R, existe função audpc pacote phytopathologyr que efetua este cálculoA função precisa de dois vetores:Tempo em que cada medida foi realizada (exemplo abaixo, dias após repicagem da colônia).Quantificação da doença (exemplo abaixo, o diâmetro da colônia em cada tempo.)","code":"\ntempo <- c(0, 1, 2, 3, 5, 6, 7, 8)\ndiam <- c(0.5, 0.6, 0.7, 1.2, 3.1, 5.2, 6.6, 8.8)\nlibrary(phytopathologyr)\naudpc(y = diam, time = tempo)## [1] 24.2"},{"path":"aaccm.html","id":"aaccmexp","chapter":"Capítulo 2 Área Abaixo da Curva de Crescimento Micelial - AACCM","heading":"2.1 Como utilizar a AACCM na análise de experimentos","text":"AACCM é um valor único que integra evolução da curva de progresso da doença em todo o tempo de avaliação.curvas de progressos só podem ser comparadas entre si quando tem exatamente o mesmo tempo de duração, isto é, o tempo de avaliação deve ser exatamente igual.Em experimentos comparativos, devemos calcular AACCM para cada repetição de cada tratamento, afim de prossegurimos com análises estatísticas posteriormente.O primeiro passo é digitar os seus dados em um formato organizado e passível de leitura pelo software R. Vou exemplificar digitação em uma planilha Excel, pois é o formato amplamente utilizado em nosso laboratório.planilha Excel deve ser organizada da seguinte forma:\nFigura 2.2: Exemplo de planilha Excel\nÉ recomendável utilizar primeiras linhas para fazer uam descrição dos dados apresentadas (metadados). Utilize quantas linhas desejar, pois estas serão ignoradas momento da importação da planilha para o R. Neste exemplo, 6 primeiras linhas são auxiliares, e os dados propriamente ditos começam na linha 7.primeiras colunas devem conter os tratamentos ou fatores e repetições.colunas seguintes seguem um padrão: primeira medida diâmetro (), segunda medida diâmetro (B) e média destas duas medidas. Esta última recebe cabeçalho o momento em que foi efetuada medição, seja data, data e hora, depender planejamento seu experimento.Com planilha Excel devidamente preenchida e todos os valores conferidos, podemos seguir com importação desta para o ambiente R.Uma planilha de exemplo está aqui para download.Para isso, utilizamos função read_excel pacote readxlNa sequência, devemos “limpar” colunas que não precisamos com funções dos pacotes dplyr e tidyr. Este passo é bastante variável em função da forma como os dados foram organizados/digitados anteriormente. Vou exemplificar conforme planilha Excel mostrada na figura 2.2.Após estas instruções, é possível calcular AACCM para cada repetição de cada tratamento, com função audpc pacote phytopathologyr da seguinte forma:Por fim, o resultado destes cálculos pode ser salvo para utilização nas análises posteriores. O formato .csv é idela para salvar, visto que sua importação pelo R é facilmente executado e pode ser aberto em qualquer computador para leitura.","code":"\ndados_aaccm <- readxl::read_excel(\"data/aaccm.xlsx\", skip = 6)## New names:\n## • `a` -> `a...4`\n## • `b` -> `b...5`\n## • `a` -> `a...7`\n## • `b` -> `b...8`\n## • `a` -> `a...10`\n## • `b` -> `b...11`\n## • `a` -> `a...13`\n## • `b` -> `b...14`\n## • `a` -> `a...16`\n## • `b` -> `b...17`\n## • `a` -> `a...19`\n## • `b` -> `b...20`\n## • `a` -> `a...22`\n## • `b` -> `b...23`\n## • `a` -> `a...25`\n## • `b` -> `b...26`\n## • `a` -> `a...28`\n## • `b` -> `b...29`\n## • `a` -> `a...31`\n## • `b` -> `b...32`## Rows: 40\n## Columns: 33\n## $ oe                   <chr> \"Test\", \"Test\", \"Test\", \"Test\", \"Test\", \"Cravo\", …\n## $ dose                 <dbl> 0, 0, 0, 0, 0, 50, 50, 50, 50, 50, 150, 150, 150,…\n## $ rep                  <dbl> 1, 2, 3, 4, 5, 1, 2, 3, 4, 5, 1, 2, 3, 4, 5, 1, 2…\n## $ a...4                <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n## $ b...5                <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n## $ `44620.333333333336` <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n## $ a...7                <dbl> 1.0, 1.4, 0.8, 1.4, 1.3, 0.0, 0.0, 0.0, 0.0, 0.0,…\n## $ b...8                <dbl> 1.30, 1.10, 1.10, 1.10, 0.31, 0.00, 0.00, 0.00, 0…\n## $ `44620.756944444445` <dbl> 1.150, 1.250, 0.950, 1.250, 0.805, 0.000, 0.000, …\n## $ a...10               <dbl> 3.4, 3.7, 3.0, 4.0, 3.4, 1.9, 2.0, 1.5, 2.1, 1.5,…\n## $ b...11               <dbl> 3.4, 3.5, 3.1, 3.6, 3.6, 1.7, 2.0, 1.3, 2.2, 1.5,…\n## $ `44621.37777777778`  <dbl> 3.40, 3.60, 3.05, 3.80, 3.50, 1.80, 2.00, 1.40, 2…\n## $ a...13               <dbl> 5.2, 5.5, 5.5, 5.8, 5.3, 3.6, 3.5, 2.3, 3.6, 2.4,…\n## $ b...14               <dbl> 5.3, 5.4, 5.0, 5.6, 5.5, 3.4, 3.6, 2.6, 3.6, 3.1,…\n## $ `44621.765972222223` <dbl> 5.25, 5.45, 5.25, 5.70, 5.40, 3.50, 3.55, 2.45, 3…\n## $ a...16               <dbl> 8.3, 8.3, 8.1, 8.6, 8.1, 6.5, 6.8, 5.9, 6.6, 5.8,…\n## $ b...17               <dbl> 8.0, 8.6, 8.1, 9.0, 8.0, 6.1, 6.6, 5.4, 6.7, 6.0,…\n## $ `44622.316666666666` <dbl> 8.15, 8.45, 8.10, 8.80, 8.05, 6.30, 6.70, 5.65, 6…\n## $ a...19               <dbl> 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 8.1, 9.0, 8.0,…\n## $ b...20               <dbl> 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 8.2, 9.0, 8.1,…\n## $ `44622.720833333333` <dbl> 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 8.15, 9…\n## $ a...22               <dbl> 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0,…\n## $ b...23               <dbl> 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0,…\n## $ `44623.380555555559` <dbl> 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9…\n## $ a...25               <dbl> 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 8.7, 9.0, 9.0,…\n## $ b...26               <dbl> 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0,…\n## $ `44623.654166666667` <dbl> 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 8.85, 9…\n## $ a...28               <dbl> 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0,…\n## $ b...29               <dbl> 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0,…\n## $ `44624.388888888891` <dbl> 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9…\n## $ a...31               <dbl> 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0,…\n## $ b...32               <dbl> 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0, 9.0,…\n## $ `44625.279861111114` <dbl> 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9.00, 9…\nlibrary(dplyr)\nlibrary(tidyr)\n\ndados_aaccm <- dados_aaccm %>%\n  select(!starts_with(c(\"a\", \"b\"))) %>%\n  pivot_longer(4:length(.), names_to = \"tempo\", values_to = \"diametro\") %>%\n  mutate(tempo = as.numeric(tempo))## Rows: 400\n## Columns: 5\n## $ oe       <chr> \"Test\", \"Test\", \"Test\", \"Test\", \"Test\", \"Test\", \"Test\", \"Test…\n## $ dose     <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n## $ rep      <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3…\n## $ tempo    <dbl> 44620.33, 44620.76, 44621.38, 44621.77, 44622.32, 44622.72, 4…\n## $ diametro <dbl> 0.00, 1.15, 3.40, 5.25, 8.15, 9.00, 9.00, 9.00, 9.00, 9.00, 0…\nlibrary(phytopathologyr)\ndados_aaccm <- dados_aaccm %>%\n  group_by(oe, dose, rep) %>%\n  summarise(area = audpc(diametro, tempo)) %>%\n  ungroup()## `summarise()` has grouped output by 'oe', 'dose'. You can override using the\n## `.groups` argument.## Rows: 40\n## Columns: 4\n## $ oe   <chr> \"Cravo\", \"Cravo\", \"Cravo\", \"Cravo\", \"Cravo\", \"Cravo\", \"Cravo\", \"C…\n## $ dose <dbl> 50, 50, 50, 50, 50, 150, 150, 150, 150, 150, 300, 300, 300, 300, …\n## $ rep  <dbl> 1, 2, 3, 4, 5, 1, 2, 3, 4, 5, 1, 2, 3, 4, 5, 1, 2, 3, 4, 5, 1, 2,…\n## $ area <dbl> 30.408993, 30.724340, 28.876163, 30.799618, 29.209236, 28.395295,…\nreadr::write_csv2(dados_aaccm, \"data/area.csv\")"},{"path":"ivcm.html","id":"ivcm","chapter":"Capítulo 3 Índice de Velocidade do Crescimento Micelial - IVCM","heading":"Capítulo 3 Índice de Velocidade do Crescimento Micelial - IVCM","text":"Complementar AACCM, avalia velocidade média crescimento micelial. Pode ser utilizado quando curvas de progresso tem duração diferentes.Retomando o exemplo da Figura 2.1, o IVCM é calculado pela seguinte fórmula:\\[\nIVCM =  \\sum ((X_{+1}-X_i) \\cdot (T_{+1}-T_i))\n\\]software R, existe função mvi pacote phytopathologyr que efetua este cálculoA função precisa de dois vetores:Tempo em que cada medida foi realizada (exemplo abaixo, dias após repicagem da colônia).Quantificação da doença (exemplo abaixo, o diâmetro da colônia em cada tempo.)","code":"\ntempo <- c(0, 1, 2, 3, 5, 6, 7, 8)\ndiam <- c(0.5, 0.6, 0.7, 1.2, 3.1, 5.2, 6.6, 8.8)\nlibrary(phytopathologyr)\nmvi(y = diam, time = tempo)## [1] 1.05"},{"path":"ivcm.html","id":"como-utilizar-o-ivcm-na-análise-de-experimentos","chapter":"Capítulo 3 Índice de Velocidade do Crescimento Micelial - IVCM","heading":"3.1 Como utilizar o IVCM na análise de experimentos","text":"O IVCM segue mesma lógica utilizada cálculo da AACCM. Para mais detalhes, consulte o item 2.1.O cálculo IVCM para cada repetição de cada tratamento é feito com função mvi pacote phytopathologyr:Por fim, o resultado destes cálculos pode ser salvo para utilização nas análises posteriores. O formato .csv é idela para salvar, visto que sua importação pelo R é facilmente executado e pode ser aberto em qualquer computador para leitura.","code":"\nlibrary(phytopathologyr)\ndados_ivcm <- dados_ivcm %>%\n  group_by(oe, dose, rep) %>%\n  summarise(area = mvi(diametro, tempo)) %>%\n  ungroup()## `summarise()` has grouped output by 'oe', 'dose'. You can override using the\n## `.groups` argument.\ndados_ivcm## # A tibble: 40 × 4\n##    oe     dose   rep     area\n##    <chr> <dbl> <dbl>    <dbl>\n##  1 Cravo    50     1  2.12   \n##  2 Cravo    50     2  2.07   \n##  3 Cravo    50     3  1.99   \n##  4 Cravo    50     4  2.06   \n##  5 Cravo    50     5  2.01   \n##  6 Cravo   150     1  1.54   \n##  7 Cravo   150     2 -0.00961\n##  8 Cravo   150     3  1.20   \n##  9 Cravo   150     4 -0.00303\n## 10 Cravo   150     5  0.558  \n## # … with 30 more rows\nreadr::write_csv2(dados_ivcm, \"data/ivcm.csv\")"},{"path":"análise-de-variância.html","id":"análise-de-variância","chapter":"Capítulo 4 Análise de Variância","heading":"Capítulo 4 Análise de Variância","text":"Veja o material publica em biostat.tolentino.pro.brAnálise de Variância para 1 fatorAnálise de Variância para 2 fatores","code":""},{"path":"surv.html","id":"surv","chapter":"Capítulo 5 Análise de sobrevivência","heading":"Capítulo 5 Análise de sobrevivência","text":"Na análise de sobrevivência variável dependente é o tempo até ocorrência de determinado evento. Compara-se rapidez com que ocorreu determinado evento, ao contrário de comparar percentagens de ocorrência deste evento ao final de determinado tempo.É técnica ideal para analisar respostas binárias (ter ou não ter um evento) em estudos temporais.momento da análise, podem haver indivíduos censurados, isto é, que não desenvolveram o evento até o fim tempo de observação estudo (independentemente motivo).","code":""},{"path":"surv.html","id":"curva-de-sobrevivência-de-kaplan-meier","chapter":"Capítulo 5 Análise de sobrevivência","heading":"5.1 Curva de sobrevivência de Kaplan-Meier","text":"curvas apresentam uma forma de “escada”. eixo vertical está porcentagem de sobrevivência, ou seja, probabilidade de não ocorrer o evento.","code":""},{"path":"surv.html","id":"exemplo-de-uma-análise-de-sobrevivência","chapter":"Capítulo 5 Análise de sobrevivência","heading":"5.2 Exemplo de uma Análise de Sobrevivência","text":"Considere os dados presentes na planilha surv.xlsx.Os dados representam germinação de escleródios de S. rolfsii submetidos tratamentos com óleo essencial de Cravo 5000 ppm em diferentes tempos (30, 90 e 180 minutos).organização da planilha deve ser feita rigorosamente desta forma:1ª coluna: nome dos tratamentos;2ª coluna: número das repetições;3ª coluna: número de indivíduos em cada repetição;4ª coluna em diante: número de indivíduos que apresentaram o evento estudado com o nome das colunas representando o tempo;Última coluna: números de indivíduos censurados.Caso esta organização seja seguida rigorosamente, podemos utilizar função surv_data para preparar os dados para Análise de sobrevivência.Iniciamos então análise com o pacote survival:Comparação pareada (pairwise) entre duas curvas de sobrevivência utilizando o teste G-rho (logrank test).exemplo abaixo, testou-se diferença entre os tratamentos TETS030 e CR030.E curvas de sobrevivência podem ser plotadas com o pacote ggplot2, utilizando geometria geom_step.","code":"\nsource(\"script/surv_data.R\")\nsobrev <- readxl::read_excel(\"data/surv.xlsx\", skip=2) %>% surv_data()\nlibrary(survival)\nan_sobrev <- survfit(Surv(time, status)~trat, data=sobrev)\nan_sobrev## Call: survfit(formula = Surv(time, status) ~ trat, data = sobrev)\n## \n##               n events median 0.95LCL 0.95UCL\n## trat=CR030   48     47    7.5       7       9\n## trat=CR090   48     45    7.0       6       7\n## trat=CR180   48      0     NA      NA      NA\n## trat=TEST030 48     48    3.0       2       4\n## trat=TEST090 48     48    3.0       2       4\n## trat=TEST180 48     48    3.0       3       4\nsummary(an_sobrev, censored = TRUE)## Call: survfit(formula = Surv(time, status) ~ trat, data = sobrev)\n## \n##                 trat=CR030 \n##  time n.risk n.event survival std.err lower 95% CI upper 95% CI\n##     3     48       2   0.9583  0.0288        0.903        1.000\n##     4     46       6   0.8333  0.0538        0.734        0.946\n##     5     40       3   0.7708  0.0607        0.661        0.899\n##     7     37      13   0.5000  0.0722        0.377        0.663\n##     8     24       7   0.3542  0.0690        0.242        0.519\n##     9     17       6   0.2292  0.0607        0.136        0.385\n##    10     11       1   0.2083  0.0586        0.120        0.362\n##    12     10       9   0.0208  0.0206        0.003        0.145\n## \n##                 trat=CR090 \n##  time n.risk n.event survival std.err lower 95% CI upper 95% CI\n##     3     48       3   0.9375  0.0349       0.8715        1.000\n##     4     45       2   0.8958  0.0441       0.8135        0.987\n##     5     43       8   0.7292  0.0641       0.6137        0.866\n##     6     35       6   0.6042  0.0706       0.4805        0.760\n##     7     29      14   0.3125  0.0669       0.2054        0.475\n##     8     15       6   0.1875  0.0563       0.1041        0.338\n##     9      9       5   0.0833  0.0399       0.0326        0.213\n##    12      4       1   0.0625  0.0349       0.0209        0.187\n## \n##                 trat=CR180 \n##         time       n.risk      n.event     survival      std.err lower 95% CI \n##           12           48            0            1            0            1 \n## upper 95% CI \n##            1 \n## \n##                 trat=TEST030 \n##  time n.risk n.event survival std.err lower 95% CI upper 95% CI\n##     2     48      23   0.5208  0.0721       0.3971        0.683\n##     3     25       8   0.3542  0.0690       0.2417        0.519\n##     4     17      12   0.1042  0.0441       0.0454        0.239\n##     5      5       4   0.0208  0.0206       0.0030        0.145\n##     6      1       1   0.0000     NaN           NA           NA\n## \n##                 trat=TEST090 \n##  time n.risk n.event survival std.err lower 95% CI upper 95% CI\n##     2     48      19   0.6042  0.0706       0.4805        0.760\n##     3     29       9   0.4167  0.0712       0.2981        0.582\n##     4     20      11   0.1875  0.0563       0.1041        0.338\n##     5      9       7   0.0417  0.0288       0.0107        0.162\n##     6      2       2   0.0000     NaN           NA           NA\n## \n##                 trat=TEST180 \n##  time n.risk n.event survival std.err lower 95% CI upper 95% CI\n##     2     48      11   0.7708  0.0607       0.6606        0.899\n##     3     37      18   0.3958  0.0706       0.2791        0.561\n##     4     19       8   0.2292  0.0607       0.1364        0.385\n##     5     11       8   0.0625  0.0349       0.0209        0.187\n##     6      3       3   0.0000     NaN           NA           NA\nsobrev %>% filter(trat==\"TEST030\" | trat==\"CR030\") %>% \nsurvdiff(Surv(time, status) ~ trat, data = .)## Call:\n## survdiff(formula = Surv(time, status) ~ trat, data = .)\n## \n##               N Observed Expected (O-E)^2/E (O-E)^2/V\n## trat=CR030   48       47     74.4      10.1      78.4\n## trat=TEST030 48       48     20.6      36.5      78.4\n## \n##  Chisq= 78.4  on 1 degrees of freedom, p= <2e-16\n g <-\n    data.frame(trat=summary(an_sobrev, c = T)$strata,\n          time=summary(an_sobrev, c = T)$time,\n          surv=summary(an_sobrev, c = T)$surv)\n\ng##            trat time       surv\n## 1    trat=CR030    3 0.95833333\n## 2    trat=CR030    4 0.83333333\n## 3    trat=CR030    5 0.77083333\n## 4    trat=CR030    7 0.50000000\n## 5    trat=CR030    8 0.35416667\n## 6    trat=CR030    9 0.22916667\n## 7    trat=CR030   10 0.20833333\n## 8    trat=CR030   12 0.02083333\n## 9    trat=CR090    3 0.93750000\n## 10   trat=CR090    4 0.89583333\n## 11   trat=CR090    5 0.72916667\n## 12   trat=CR090    6 0.60416667\n## 13   trat=CR090    7 0.31250000\n## 14   trat=CR090    8 0.18750000\n## 15   trat=CR090    9 0.08333333\n## 16   trat=CR090   12 0.06250000\n## 17   trat=CR180   12 1.00000000\n## 18 trat=TEST030    2 0.52083333\n## 19 trat=TEST030    3 0.35416667\n## 20 trat=TEST030    4 0.10416667\n## 21 trat=TEST030    5 0.02083333\n## 22 trat=TEST030    6 0.00000000\n## 23 trat=TEST090    2 0.60416667\n## 24 trat=TEST090    3 0.41666667\n## 25 trat=TEST090    4 0.18750000\n## 26 trat=TEST090    5 0.04166667\n## 27 trat=TEST090    6 0.00000000\n## 28 trat=TEST180    2 0.77083333\n## 29 trat=TEST180    3 0.39583333\n## 30 trat=TEST180    4 0.22916667\n## 31 trat=TEST180    5 0.06250000\n## 32 trat=TEST180    6 0.00000000\nlibrary(ggplot2)\ng%>% filter(trat==\"trat=CR030\") %>% ggplot( aes(x=time, y=surv))+\n  geom_step()"}]
